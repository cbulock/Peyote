---
layout: default
---

<div class="row blue pad box">
	<div class="span8">
		<h2 class="white shadow-text valign">Build MySQL Queries the OOP Way</h2>

		<div><a href="downloads/Peyote-0.6.0.zip" class="button large">Download</a></div>

		<h4 class="white shadow-text">and for the composer crowd</h4>

<div class="code"><pre class="shrink">"require":{
	"davewid/peyote": "0.6.*"
}</pre></div>

	</div>
	<div class="span4">
		<img src="assets/peyote.png" alt="Peyote" class="fit" />
	</div>
</div>

<div class="row pad box">
	<div class="span4">
		<h3 class="valign">Easy to Learn</h3>
		<p>Build database queries in an easy to understand and
			highly reusable way.</p>
	</div>
	<div class="span4">
		<h3 class="valign">Open Source</h3>
		<p>Peyote is licensed under the fairly open
			<a href="http://www.opensource.org/licenses/mit-license.php">MIT</a> license.
			Use the	library as you wish!</p>
	</div>
	<div class="span4">
		<h3 class="valign">Standards Compliant</h3>
		<p>Peyote is in compliance with
			<a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md">PSR-0</a>
			and
			<a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-1-basic-coding-standard.md">PSR-1</a>
		</p>
	</div>
</div>

<div class="row pad box">
	<h2 class="headline">Example</h2>

	<div class="code">
		<pre class="shrink"><span class="c1">// Create a PDO instance</span>
<span class="nv">$pdo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="nv">$dsn</span><span class="p">,</span> <span class="nv">$user</span><span class="p">,</span> <span class="nv">$password</span><span class="p">);</span>

<span class="c1">// Create a SELECT query</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Peyote\Select</span><span class="p">(</span><span class="s1">'user'</span><span class="p">);</span>
<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'user_id'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="c1">// Build the PDOStatement</span>
<span class="nv">$statement</span> <span class="o">=</span> <span class="nv">$pdo</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$query</span><span class="o">-&gt;</span><span class="na">compile</span><span class="p">());</span>

<span class="c1">// Run the query</span>
<span class="nv">$statement</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">(</span><span class="nv">$query</span><span class="o">-&gt;</span><span class="na">getParams</span><span class="p">());</span>

<span class="c1">// Fetch results</span>
<span class="nv">$results</span> <span class="o">=</span> <span class="nv">$statement</span><span class="o">-&gt;</span><span class="na">fetchAll</span><span class="p">();</span>
</pre>
	</div>
</div>

<div class="row pad box">
	<div class="span6">
		<h3 class="headline">Select</h3>
		<div class="code">
			<pre class="shrink"><span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s2">"testing@foo.com"</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s2">"youllneverguess"</span>
<span class="p">);</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Peyote\Insert</span><span class="p">(</span><span class="s1">'user'</span><span class="p">);</span>
<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">columns</span><span class="p">(</span><span class="nb">array_keys</span><span class="p">(</span><span class="nv">$data</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">values</span><span class="p">(</span><span class="nb">array_values</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">compile</span><span class="p">();</span>
<span class="c1">// INSERT INTO user (email, password) VALUES (?, ?)</span>
</pre>
		</div>
	</div>
	<div class="span6">
		<h3 class="headline">Insert</h3>
		<div class="code">
			<pre class="shrink"><span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'email'</span> <span class="o">=&gt;</span> <span class="s2">"testing@foo.com"</span><span class="p">,</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s2">"youllneverguess"</span>
<span class="p">);</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Peyote\Insert</span><span class="p">(</span><span class="s1">'user'</span><span class="p">);</span>
<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">columns</span><span class="p">(</span><span class="nb">array_keys</span><span class="p">(</span><span class="nv">$data</span><span class="p">))</span><span class="o">-&gt;</span><span class="na">values</span><span class="p">(</span><span class="nb">array_values</span><span class="p">(</span><span class="nv">$data</span><span class="p">));</span>

<span class="k">echo</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">compile</span><span class="p">();</span>
<span class="c1">// INSERT INTO user (email, password) VALUES (?, ?)</span>
</pre>
		</div>
	</div>
</div>

<div class="row pad box">
	<div class="span6">
		<h3 class="headline">Update</h3>
		<div class="code">
			<pre class="shrink"><span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s2">"iguesssomebodyguessed"</span>
<span class="p">);</span>

<span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Peyote\Update</span><span class="p">(</span><span class="s1">'user'</span><span class="p">);</span>
<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'user_id'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">compile</span><span class="p">();</span>
<span class="c1">// UPDATE user SET password = ? WHERE user_id = ?</span>
</pre>
		</div>
	</div>
	<div class="span6">
		<h3 class="headline">Delete</h3>
		<div class="code">
			<pre class="shrink"><span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\Peyote\Delete</span><span class="p">(</span><span class="s1">'user'</span><span class="p">);</span>
<span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">'user_id'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">compile</span><span class="p">();</span>
<span class="c1">// DELETE FROM user WHERE user_id = ?</span>
</pre>
		</div>
	</div>
</div>


